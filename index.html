<!DOCTYPE html>
<html>
<head>
  <style>
    .error {
        color: red;
    }
  </style>
  <script type="text/javascript" src="https://cdn.jsdelivr.net/npm//vega@5"></script>
  <script type="text/javascript" src="https://cdn.jsdelivr.net/npm//vega-lite@4.17.0"></script>
  <script type="text/javascript" src="https://cdn.jsdelivr.net/npm//vega-embed@6"></script>
</head>
<body>
  <div id="vis"></div>
  <script>
    (function(vegaEmbed) {
      var spec = {"config": {"view": {"continuousWidth": 400, "continuousHeight": 300, "stroke": "transparent"}, "axis": {"labelFontSize": 15, "titleFontSize": 20}, "legend": {"labelFontSize": 16, "titleFontSize": 20, "titleLimit": 600}}, "vconcat": [{"data": {"name": "data-06142f0048207f412b42fa39e183ba3e"}, "mark": "bar", "encoding": {"color": {"field": "category", "legend": {"title": "Monthly costs"}, "scale": {"scheme": "teals"}, "type": "nominal"}, "tooltip": [{"field": "category", "type": "nominal"}, {"field": "cost", "type": "quantitative"}], "x": {"aggregate": "sum", "axis": {"format": "$.3s", "title": "Monthly Cost per Resident"}, "field": "cost", "type": "quantitative"}, "y": {"axis": {"title": null}, "field": "scenario", "sort": ["23 Pond St, Greenfield, MA"], "type": "ordinal"}}, "selection": {"selector020": {"type": "single", "fields": ["oil"], "init": {"oil": 375}, "bind": {"input": "range", "max": 750, "min": 0, "name": "\ud83e\ude94 Heating oil per year", "step": 37.5}}, "selector019": {"type": "single", "fields": ["electric"], "init": {"electric": 1598}, "bind": {"input": "range", "max": 3196, "min": 0, "name": "\ud83d\udd0c Electric per year", "step": 159.8}}, "selector018": {"type": "single", "fields": ["propane"], "init": {"propane": 1135}, "bind": {"input": "range", "max": 2270, "min": 0, "name": "\ud83e\udd95 Propane per year", "step": 113.5}}, "selector017": {"type": "single", "fields": ["insurance"], "init": {"insurance": 500}, "bind": {"input": "range", "max": 800, "min": 300, "name": "\ud83c\udfe1 Home Insurance (annual)", "step": 100}}, "selector016": {"type": "single", "fields": ["bookkeeping"], "init": {"bookkeeping": 230}, "bind": {"input": "radio", "options": [230, 460, 1150], "labels": ["Extra Small", "Small", "Medium"], "name": "\ud83d\udcd4 Bookkeeping.coop Service Plan"}}, "selector015": {"type": "single", "fields": ["maintaince"], "init": {"maintaince": 0.03}, "bind": {"input": "range", "max": 0.05, "min": 0.01, "name": "\ud83d\udd27 % of building value saved for maintaince", "step": 0.01}}, "selector014": {"type": "single", "fields": ["lawyer_fees"], "init": {"lawyer_fees": 5000}, "bind": {"input": "range", "max": 20000, "min": 2000, "name": "\ud83d\udcbc Lawyer fees and closing costs", "step": 1000}}, "selector013": {"type": "single", "fields": ["loan_duration"], "init": {"loan_duration": 360}, "bind": {"input": "radio", "options": [60, 120, 180, 360, 0], "labels": ["5 years", "10 years", "15 years", "30 years", "Investment"], "name": "\ud83d\uddd3 Loan Duration"}}, "selector012": {"type": "single", "fields": ["interest_rate"], "init": {"interest_rate": 0.03}, "bind": {"input": "range", "max": 0.1, "min": 0, "name": "\ud83d\udcc8 Investor interest rate", "step": 0.01}}, "selector011": {"type": "single", "fields": ["residents"], "init": {"residents": 4}, "bind": {"input": "range", "max": 6, "min": 1, "name": "\ud83d\udc68\u200d\ud83d\udc69\u200d\ud83d\udc67\u200d\ud83d\udc66 # of ppl in house", "step": 1}}}, "transform": [{"calculate": "if(((datum.category === 'Bookkeeping') && (datum.scenario === '23 Pond St, Greenfield, MA')),(selector016.bookkeeping[0] / (0 + selector011.residents[0])),if(((datum.category === 'Insurance') && (datum.scenario === '23 Pond St, Greenfield, MA')),((selector017.insurance[0] / 12) / (0 + selector011.residents[0])),if(((datum.category === 'Maintenance') && (datum.scenario === '23 Pond St, Greenfield, MA')),((((selector015.maintaince[0] * 95) * 1000) / 12) / (0 + selector011.residents[0])),if(((datum.category === 'Internet') && (datum.scenario === '23 Pond St, Greenfield, MA')),(60 / (0 + selector011.residents[0])),if(((datum.category === 'Heating Oil') && (datum.scenario === '23 Pond St, Greenfield, MA')),((selector020.oil[0] / 12) / (0 + selector011.residents[0])),if(((datum.category === 'Electric') && (datum.scenario === '23 Pond St, Greenfield, MA')),((selector019.electric[0] / 12) / (0 + selector011.residents[0])),if(((datum.category === 'Propane') && (datum.scenario === '23 Pond St, Greenfield, MA')),((selector018.propane[0] / 12) / (0 + selector011.residents[0])),if(((datum.category === 'Property Tax') && (datum.scenario === '23 Pond St, Greenfield, MA')),(259.8333333333333 / (0 + selector011.residents[0])),if(((datum.category === 'Land Trust') && (datum.scenario === '23 Pond St, Greenfield, MA')),(70 / (0 + selector011.residents[0])),if(((datum.category === 'Investors') && (datum.scenario === '23 Pond St, Greenfield, MA')),(if((selector013.loan_duration[0] === 0),((selector012.interest_rate[0] / 12) * (95000 + selector014.lawyer_fees[0])),if(((selector012.interest_rate[0] / 12) === 0),((95000 + selector014.lawyer_fees[0]) / selector013.loan_duration[0]),(((selector012.interest_rate[0] / 12) * (95000 + selector014.lawyer_fees[0])) / (1 - pow((1 + (selector012.interest_rate[0] / 12)),(-selector013.loan_duration[0])))))) / (0 + selector011.residents[0])),null))))))))))", "as": "cost"}]}, {"data": {"name": "data-d2a79cd6cfc5c1e5a4d88f8dc39fe344"}, "mark": "bar", "encoding": {"color": {"field": "category", "legend": {"title": "Living spaces"}, "scale": {"scheme": "purples"}, "type": "nominal"}, "tooltip": [{"field": "category", "type": "nominal"}, {"field": "number_people", "type": "quantitative"}], "x": {"aggregate": "sum", "axis": {"tickMinStep": 1, "title": "# Residents"}, "field": "number_people", "type": "quantitative"}, "y": {"axis": {"title": null}, "field": "scenario", "sort": ["23 Pond St, Greenfield, MA"], "type": "ordinal"}}, "selection": {"selector020": {"type": "single", "fields": ["oil"], "init": {"oil": 375}, "bind": {"input": "range", "max": 750, "min": 0, "name": "\ud83e\ude94 Heating oil per year", "step": 37.5}}, "selector019": {"type": "single", "fields": ["electric"], "init": {"electric": 1598}, "bind": {"input": "range", "max": 3196, "min": 0, "name": "\ud83d\udd0c Electric per year", "step": 159.8}}, "selector018": {"type": "single", "fields": ["propane"], "init": {"propane": 1135}, "bind": {"input": "range", "max": 2270, "min": 0, "name": "\ud83e\udd95 Propane per year", "step": 113.5}}, "selector017": {"type": "single", "fields": ["insurance"], "init": {"insurance": 500}, "bind": {"input": "range", "max": 800, "min": 300, "name": "\ud83c\udfe1 Home Insurance (annual)", "step": 100}}, "selector016": {"type": "single", "fields": ["bookkeeping"], "init": {"bookkeeping": 230}, "bind": {"input": "radio", "options": [230, 460, 1150], "labels": ["Extra Small", "Small", "Medium"], "name": "\ud83d\udcd4 Bookkeeping.coop Service Plan"}}, "selector015": {"type": "single", "fields": ["maintaince"], "init": {"maintaince": 0.03}, "bind": {"input": "range", "max": 0.05, "min": 0.01, "name": "\ud83d\udd27 % of building value saved for maintaince", "step": 0.01}}, "selector014": {"type": "single", "fields": ["lawyer_fees"], "init": {"lawyer_fees": 5000}, "bind": {"input": "range", "max": 20000, "min": 2000, "name": "\ud83d\udcbc Lawyer fees and closing costs", "step": 1000}}, "selector013": {"type": "single", "fields": ["loan_duration"], "init": {"loan_duration": 360}, "bind": {"input": "radio", "options": [60, 120, 180, 360, 0], "labels": ["5 years", "10 years", "15 years", "30 years", "Investment"], "name": "\ud83d\uddd3 Loan Duration"}}, "selector012": {"type": "single", "fields": ["interest_rate"], "init": {"interest_rate": 0.03}, "bind": {"input": "range", "max": 0.1, "min": 0, "name": "\ud83d\udcc8 Investor interest rate", "step": 0.01}}, "selector011": {"type": "single", "fields": ["residents"], "init": {"residents": 4}, "bind": {"input": "range", "max": 6, "min": 1, "name": "\ud83d\udc68\u200d\ud83d\udc69\u200d\ud83d\udc67\u200d\ud83d\udc66 # of ppl in house", "step": 1}}}, "transform": [{"calculate": "if(((datum.category === 'Number of residents') && (datum.scenario === '23 Pond St, Greenfield, MA')),selector011.residents[0],null)", "as": "number_people"}]}, {"data": {"name": "data-805cb915a16447a3870b339a5f30b179"}, "mark": "bar", "encoding": {"color": {"field": "category", "legend": {"title": "Funding needs"}, "scale": {"scheme": "greens"}, "type": "nominal"}, "tooltip": [{"field": "category", "type": "nominal"}, {"field": "upfront_cost", "type": "quantitative"}], "x": {"aggregate": "sum", "axis": {"format": "$.3s", "title": "Required Investment"}, "field": "upfront_cost", "type": "quantitative"}, "y": {"axis": {"title": null}, "field": "scenario", "sort": ["23 Pond St, Greenfield, MA"], "type": "ordinal"}}, "selection": {"selector020": {"type": "single", "fields": ["oil"], "init": {"oil": 375}, "bind": {"input": "range", "max": 750, "min": 0, "name": "\ud83e\ude94 Heating oil per year", "step": 37.5}}, "selector019": {"type": "single", "fields": ["electric"], "init": {"electric": 1598}, "bind": {"input": "range", "max": 3196, "min": 0, "name": "\ud83d\udd0c Electric per year", "step": 159.8}}, "selector018": {"type": "single", "fields": ["propane"], "init": {"propane": 1135}, "bind": {"input": "range", "max": 2270, "min": 0, "name": "\ud83e\udd95 Propane per year", "step": 113.5}}, "selector017": {"type": "single", "fields": ["insurance"], "init": {"insurance": 500}, "bind": {"input": "range", "max": 800, "min": 300, "name": "\ud83c\udfe1 Home Insurance (annual)", "step": 100}}, "selector016": {"type": "single", "fields": ["bookkeeping"], "init": {"bookkeeping": 230}, "bind": {"input": "radio", "options": [230, 460, 1150], "labels": ["Extra Small", "Small", "Medium"], "name": "\ud83d\udcd4 Bookkeeping.coop Service Plan"}}, "selector015": {"type": "single", "fields": ["maintaince"], "init": {"maintaince": 0.03}, "bind": {"input": "range", "max": 0.05, "min": 0.01, "name": "\ud83d\udd27 % of building value saved for maintaince", "step": 0.01}}, "selector014": {"type": "single", "fields": ["lawyer_fees"], "init": {"lawyer_fees": 5000}, "bind": {"input": "range", "max": 20000, "min": 2000, "name": "\ud83d\udcbc Lawyer fees and closing costs", "step": 1000}}, "selector013": {"type": "single", "fields": ["loan_duration"], "init": {"loan_duration": 360}, "bind": {"input": "radio", "options": [60, 120, 180, 360, 0], "labels": ["5 years", "10 years", "15 years", "30 years", "Investment"], "name": "\ud83d\uddd3 Loan Duration"}}, "selector012": {"type": "single", "fields": ["interest_rate"], "init": {"interest_rate": 0.03}, "bind": {"input": "range", "max": 0.1, "min": 0, "name": "\ud83d\udcc8 Investor interest rate", "step": 0.01}}, "selector011": {"type": "single", "fields": ["residents"], "init": {"residents": 4}, "bind": {"input": "range", "max": 6, "min": 1, "name": "\ud83d\udc68\u200d\ud83d\udc69\u200d\ud83d\udc67\u200d\ud83d\udc66 # of ppl in house", "step": 1}}}, "transform": [{"calculate": "if(((datum.category === 'Property') && (datum.scenario === '23 Pond St, Greenfield, MA')),95000,if(((datum.category === 'Closing costs + lawyer fees') && (datum.scenario === '23 Pond St, Greenfield, MA')),selector014.lawyer_fees[0],null))", "as": "upfront_cost"}]}], "resolve": {"scale": {"color": "independent"}}, "title": {"text": "Valley Housing Coop 38 Rush Road Cost Estimator", "anchor": "start", "fontSize": 30, "subtitle": ["\ud83d\udc47 Drag the sliders to change \ud83c\udfe1 values \u2763\ufe0f", "https://github.com/saulshanabrook/coop-finances"], "align": "left"}, "$schema": "https://vega.github.io/schema/vega-lite/v4.17.0.json", "datasets": {"data-06142f0048207f412b42fa39e183ba3e": [{"category": "Investors", "scenario": "23 Pond St, Greenfield, MA"}, {"category": "Land Trust", "scenario": "23 Pond St, Greenfield, MA"}, {"category": "Property Tax", "scenario": "23 Pond St, Greenfield, MA"}, {"category": "Propane", "scenario": "23 Pond St, Greenfield, MA"}, {"category": "Electric", "scenario": "23 Pond St, Greenfield, MA"}, {"category": "Heating Oil", "scenario": "23 Pond St, Greenfield, MA"}, {"category": "Internet", "scenario": "23 Pond St, Greenfield, MA"}, {"category": "Maintenance", "scenario": "23 Pond St, Greenfield, MA"}, {"category": "Insurance", "scenario": "23 Pond St, Greenfield, MA"}, {"category": "Bookkeeping", "scenario": "23 Pond St, Greenfield, MA"}], "data-d2a79cd6cfc5c1e5a4d88f8dc39fe344": [{"category": "Number of residents", "scenario": "23 Pond St, Greenfield, MA"}], "data-805cb915a16447a3870b339a5f30b179": [{"category": "Closing costs + lawyer fees", "scenario": "23 Pond St, Greenfield, MA"}, {"category": "Property", "scenario": "23 Pond St, Greenfield, MA"}]}};
      var embedOpt = {"mode": "vega-lite"};

      function showError(el, error){
          el.innerHTML = ('<div class="error" style="color:red;">'
                          + '<p>JavaScript Error: ' + error.message + '</p>'
                          + "<p>This usually means there's a typo in your chart specification. "
                          + "See the javascript console for the full traceback.</p>"
                          + '</div>');
          throw error;
      }
      const el = document.getElementById('vis');
      vegaEmbed("#vis", spec, embedOpt)
        .catch(error => showError(el, error));
    })(vegaEmbed);

  </script>
</body>
</html>