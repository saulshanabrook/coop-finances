{
  "$schema": "https://vega.github.io/schema/vega-lite/v4.17.0.json",
  "config": {
    "axis": {
      "labelFontSize": 15,
      "titleFontSize": 20
    },
    "legend": {
      "labelFontSize": 16,
      "titleFontSize": 20,
      "titleLimit": 600
    },
    "view": {
      "continuousHeight": 300,
      "continuousWidth": 400,
      "stroke": "transparent"
    }
  },
  "data": {
    "name": "data-e06708e2da928d0403ea75986df0874e"
  },
  "datasets": {
    "data-e06708e2da928d0403ea75986df0874e": [
      {
        "category": "Investors"
      },
      {
        "category": "Land Trust"
      },
      {
        "category": "Property Tax"
      },
      {
        "category": "Wood"
      },
      {
        "category": "Propane"
      },
      {
        "category": "Electric"
      },
      {
        "category": "Heating Oil"
      },
      {
        "category": "Internet"
      },
      {
        "category": "Maintenance"
      },
      {
        "category": "Insurance"
      },
      {
        "category": "Bookkeeping"
      }
    ]
  },
  "layer": [
    {
      "encoding": {
        "color": {
          "field": "category",
          "legend": null,
          "type": "nominal"
        },
        "theta": {
          "field": "cost",
          "stack": true,
          "type": "quantitative"
        },
        "tooltip": [
          {
            "field": "category",
            "type": "nominal"
          },
          {
            "field": "cost",
            "type": "quantitative"
          }
        ]
      },
      "mark": {
        "innerRadius": 30,
        "outerRadius": 120,
        "type": "arc"
      },
      "selection": {
        "selector016": {
          "bind": {
            "input": "range",
            "max": 6,
            "min": 2,
            "name": "\ud83e\udeba Number of residents",
            "step": 1
          },
          "fields": [
            "rooms"
          ],
          "init": {
            "rooms": 3
          },
          "type": "single"
        },
        "selector017": {
          "bind": {
            "input": "range",
            "max": 300000,
            "min": 110000,
            "name": "\ud83e\udd11 Purchase price",
            "step": 10000
          },
          "fields": [
            "property_cost"
          ],
          "init": {
            "property_cost": 170000
          },
          "type": "single"
        },
        "selector018": {
          "bind": {
            "input": "range",
            "max": 0.1,
            "min": 0,
            "name": "\ud83d\udcc8 Investor interest rate",
            "step": 0.01
          },
          "fields": [
            "interest_rate"
          ],
          "init": {
            "interest_rate": 0.03
          },
          "type": "single"
        },
        "selector019": {
          "bind": {
            "input": "radio",
            "labels": [
              "5 years",
              "10 years",
              "15 years",
              "30 years",
              "Investment"
            ],
            "name": "\ud83d\uddd3 Loan Duration",
            "options": [
              60,
              120,
              180,
              360,
              0
            ]
          },
          "fields": [
            "loan_duration"
          ],
          "init": {
            "loan_duration": 0
          },
          "type": "single"
        },
        "selector020": {
          "bind": {
            "input": "range",
            "max": 20000,
            "min": 2000,
            "name": "\ud83d\udcbc Lawyer fees and closing costs",
            "step": 1000
          },
          "fields": [
            "lawyer_fees"
          ],
          "init": {
            "lawyer_fees": 10000
          },
          "type": "single"
        },
        "selector021": {
          "bind": {
            "input": "range",
            "max": 150000,
            "min": 0,
            "name": "\ud83c\udfde Land value owned by CLT",
            "step": 10000
          },
          "fields": [
            "clt_value"
          ],
          "init": {
            "clt_value": 70000
          },
          "type": "single"
        },
        "selector022": {
          "bind": {
            "input": "range",
            "max": 10000.0,
            "min": 2000.0,
            "name": "\ud83d\udd27 Maintenance per year",
            "step": 2000.0
          },
          "fields": [
            "maintaince"
          ],
          "init": {
            "maintaince": 6000.0
          },
          "type": "single"
        },
        "selector023": {
          "bind": {
            "input": "range",
            "max": 300000,
            "min": 110000,
            "name": "\ud83c\uddfa\ud83c\uddf8 Assessed Value (for property taxes)",
            "step": 5000
          },
          "fields": [
            "assessed_value"
          ],
          "init": {
            "assessed_value": 130000
          },
          "type": "single"
        },
        "selector024": {
          "bind": {
            "input": "radio",
            "labels": [
              "Extra Small",
              "Small",
              "Medium"
            ],
            "name": "\ud83d\udcd4 Bookkeeping.coop Service Plan",
            "options": [
              230,
              460,
              1150
            ]
          },
          "fields": [
            "bookkeeping"
          ],
          "init": {
            "bookkeeping": 230
          },
          "type": "single"
        },
        "selector025": {
          "bind": {
            "input": "range",
            "max": 800,
            "min": 300,
            "name": "\ud83c\udfe1 Home Insurance (annual)",
            "step": 100
          },
          "fields": [
            "insurance"
          ],
          "init": {
            "insurance": 500
          },
          "type": "single"
        },
        "selector026": {
          "bind": {
            "input": "range",
            "max": 5,
            "min": 0,
            "name": "\ud83e\udeb5 Cords of wood per year",
            "step": 1
          },
          "fields": [
            "cords_wood"
          ],
          "init": {
            "cords_wood": 3
          },
          "type": "single"
        },
        "selector027": {
          "bind": {
            "input": "range",
            "max": 580,
            "min": 0,
            "name": "\ud83d\udd25 Price per cord wood",
            "step": 10
          },
          "fields": [
            "price_per_cord"
          ],
          "init": {
            "price_per_cord": 190
          },
          "type": "single"
        },
        "selector028": {
          "bind": {
            "input": "range",
            "max": 2270,
            "min": 0,
            "name": "\ud83e\udd95 Propane per year",
            "step": 113.5
          },
          "fields": [
            "propane"
          ],
          "init": {
            "propane": 1135
          },
          "type": "single"
        },
        "selector029": {
          "bind": {
            "input": "range",
            "max": 3196,
            "min": 0,
            "name": "\ud83d\udd0c Electric per year",
            "step": 159.8
          },
          "fields": [
            "electric"
          ],
          "init": {
            "electric": 1598
          },
          "type": "single"
        },
        "selector030": {
          "bind": {
            "input": "range",
            "max": 750,
            "min": 0,
            "name": "\ud83e\ude94 Heating oil per year",
            "step": 37.5
          },
          "fields": [
            "oil"
          ],
          "init": {
            "oil": 375
          },
          "type": "single"
        }
      },
      "transform": [
        {
          "as": "cost",
          "calculate": "if((datum.category === 'Bookkeeping'),(selector024.bookkeeping[0] / selector016.rooms[0]),if((datum.category === 'Insurance'),((selector025.insurance[0] / 12) / selector016.rooms[0]),if((datum.category === 'Maintenance'),((selector022.maintaince[0] / 12) / selector016.rooms[0]),if((datum.category === 'Internet'),(99 / selector016.rooms[0]),if((datum.category === 'Heating Oil'),((selector030.oil[0] / 12) / selector016.rooms[0]),if((datum.category === 'Electric'),((selector029.electric[0] / 12) / selector016.rooms[0]),if((datum.category === 'Propane'),((selector028.propane[0] / 12) / selector016.rooms[0]),if((datum.category === 'Wood'),(((selector026.cords_wood[0] * selector027.price_per_cord[0]) / 12) / selector016.rooms[0]),if((datum.category === 'Property Tax'),((((selector023.assessed_value[0] * 2.32) / 100) / 12) / selector016.rooms[0]),if((datum.category === 'Land Trust'),if((selector021.clt_value[0] <= 0),0,(75 / selector016.rooms[0])),if((datum.category === 'Investors'),(if((selector019.loan_duration[0] === 0),((selector018.interest_rate[0] / 12) * ((selector017.property_cost[0] + selector020.lawyer_fees[0]) - selector021.clt_value[0])),if(((selector018.interest_rate[0] / 12) === 0),(((selector017.property_cost[0] + selector020.lawyer_fees[0]) - selector021.clt_value[0]) / selector019.loan_duration[0]),(((selector018.interest_rate[0] / 12) * ((selector017.property_cost[0] + selector020.lawyer_fees[0]) - selector021.clt_value[0])) / (1 - pow((1 + (selector018.interest_rate[0] / 12)),(-selector019.loan_duration[0])))))) / selector016.rooms[0]),null)))))))))))"
        }
      ]
    },
    {
      "encoding": {
        "color": {
          "field": "category",
          "legend": null,
          "type": "nominal"
        },
        "text": {
          "field": "category",
          "type": "nominal"
        },
        "theta": {
          "field": "cost",
          "stack": true,
          "type": "quantitative"
        },
        "tooltip": [
          {
            "field": "category",
            "type": "nominal"
          },
          {
            "field": "cost",
            "type": "quantitative"
          }
        ]
      },
      "mark": {
        "align": "center",
        "radius": 155,
        "size": 15,
        "type": "text"
      },
      "transform": [
        {
          "as": "cost",
          "calculate": "if((datum.category === 'Bookkeeping'),(selector024.bookkeeping[0] / selector016.rooms[0]),if((datum.category === 'Insurance'),((selector025.insurance[0] / 12) / selector016.rooms[0]),if((datum.category === 'Maintenance'),((selector022.maintaince[0] / 12) / selector016.rooms[0]),if((datum.category === 'Internet'),(99 / selector016.rooms[0]),if((datum.category === 'Heating Oil'),((selector030.oil[0] / 12) / selector016.rooms[0]),if((datum.category === 'Electric'),((selector029.electric[0] / 12) / selector016.rooms[0]),if((datum.category === 'Propane'),((selector028.propane[0] / 12) / selector016.rooms[0]),if((datum.category === 'Wood'),(((selector026.cords_wood[0] * selector027.price_per_cord[0]) / 12) / selector016.rooms[0]),if((datum.category === 'Property Tax'),((((selector023.assessed_value[0] * 2.32) / 100) / 12) / selector016.rooms[0]),if((datum.category === 'Land Trust'),if((selector021.clt_value[0] <= 0),0,(75 / selector016.rooms[0])),if((datum.category === 'Investors'),(if((selector019.loan_duration[0] === 0),((selector018.interest_rate[0] / 12) * ((selector017.property_cost[0] + selector020.lawyer_fees[0]) - selector021.clt_value[0])),if(((selector018.interest_rate[0] / 12) === 0),(((selector017.property_cost[0] + selector020.lawyer_fees[0]) - selector021.clt_value[0]) / selector019.loan_duration[0]),(((selector018.interest_rate[0] / 12) * ((selector017.property_cost[0] + selector020.lawyer_fees[0]) - selector021.clt_value[0])) / (1 - pow((1 + (selector018.interest_rate[0] / 12)),(-selector019.loan_duration[0])))))) / selector016.rooms[0]),null)))))))))))"
        }
      ]
    },
    {
      "encoding": {
        "text": {
          "aggregate": "sum",
          "field": "cost",
          "format": "$.2s",
          "type": "quantitative"
        }
      },
      "height": 400,
      "mark": {
        "radius": 0,
        "size": 20,
        "type": "text"
      },
      "title": {
        "fontSize": 25,
        "text": "Price per room per month"
      },
      "transform": [
        {
          "as": "cost",
          "calculate": "if((datum.category === 'Bookkeeping'),(selector024.bookkeeping[0] / selector016.rooms[0]),if((datum.category === 'Insurance'),((selector025.insurance[0] / 12) / selector016.rooms[0]),if((datum.category === 'Maintenance'),((selector022.maintaince[0] / 12) / selector016.rooms[0]),if((datum.category === 'Internet'),(99 / selector016.rooms[0]),if((datum.category === 'Heating Oil'),((selector030.oil[0] / 12) / selector016.rooms[0]),if((datum.category === 'Electric'),((selector029.electric[0] / 12) / selector016.rooms[0]),if((datum.category === 'Propane'),((selector028.propane[0] / 12) / selector016.rooms[0]),if((datum.category === 'Wood'),(((selector026.cords_wood[0] * selector027.price_per_cord[0]) / 12) / selector016.rooms[0]),if((datum.category === 'Property Tax'),((((selector023.assessed_value[0] * 2.32) / 100) / 12) / selector016.rooms[0]),if((datum.category === 'Land Trust'),if((selector021.clt_value[0] <= 0),0,(75 / selector016.rooms[0])),if((datum.category === 'Investors'),(if((selector019.loan_duration[0] === 0),((selector018.interest_rate[0] / 12) * ((selector017.property_cost[0] + selector020.lawyer_fees[0]) - selector021.clt_value[0])),if(((selector018.interest_rate[0] / 12) === 0),(((selector017.property_cost[0] + selector020.lawyer_fees[0]) - selector021.clt_value[0]) / selector019.loan_duration[0]),(((selector018.interest_rate[0] / 12) * ((selector017.property_cost[0] + selector020.lawyer_fees[0]) - selector021.clt_value[0])) / (1 - pow((1 + (selector018.interest_rate[0] / 12)),(-selector019.loan_duration[0])))))) / selector016.rooms[0]),null)))))))))))"
        }
      ],
      "width": 900
    }
  ],
  "title": {
    "align": "left",
    "anchor": "start",
    "fontSize": 40,
    "subtitle": [
      "yr = \ud83c\uddfa\ud83c\uddf8 * 2.32% (tax rate) + \ud83e\udeb5 * \ud83d\udd25 + \ud83e\udd95 + \ud83d\udd0c + \ud83e\ude94 + $99 (internet) + \ud83c\udfe1 + \ud83d\udd27",
      "Investors = \ud83e\uddee(r=\ud83d\udcc8 / 12, N=\ud83d\uddd3 * 12, P=\ud83e\udd11 + \ud83d\udcbc - \ud83c\udfde)",
      "monthly cost = (yr / 12 + Investors (+ $75 (Land Trust Fee) if \ud83c\udfde > $0)) / \ud83e\udeba",
      "\ud83e\uddee = https://en.wikipedia.org/wiki/Mortgage_calculator#Monthly_payment_formula",
      "source: https://github.com/saulshanabrook/coop-finances"
    ],
    "text": "\ud83d\udc47 Drag the sliders to change \ud83c\udfe1 values \u2763\ufe0f"
  }
}